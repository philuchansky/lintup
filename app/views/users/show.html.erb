<%= image_tag "default_avatar.jpg" %>

<h1><%= "#{@user.fname} #{@user.lname}"%></h1>
<h2><%= @user.username %></h2>
<h3>Snippets: <%= @user.snippets.count %></h3>
Session ID: <%= session[:user_id] %>|
User ID Param: <%= params[:id] %>
<% if session[:user_id] == @user.id%>
	<%= link_to 'Account Settings', edit_user_path %>
<% end %>

<% if @user.github_username %>
	<a href="http://github.com/<%= @user.github_username %>" target="_blank">Github</a>
<% end %>


<div class="snippets">
<% @user.snippets.order("created_at DESC").each do |s| %>
		<hr>
    <div class="snippet">
	    <h3><%= link_to s.title, snippet_path(s.id) %></h3>
	    <h5><%= time_ago_in_words(s.created_at) %></h5>
	    <h4>Language: <%= language_modes.find {|language| language[:language_mode] == s.language}[:name] %></h4>
	    <div>Likes: <%= s.likes.count %></div>

	    <textarea disabled id="snippet-<%= s.id %>"><%= s.content %></textarea>

        <% if logged_in? %>
            <% if current_user.id == s.user.id %>
                <%= link_to 'Edit', edit_snippet_path(s.id) %> | <%= link_to 'Delete', delete_snippet_path(s.id) %>
            <% else %>
                <% if current_user.already_likes?(s) %>
                    <%= link_to 'Unlike', controller: 'likes', action: 'destroy', id: s.id %>
                <% else %>
                    <%= link_to 'Like', controller: 'likes', action: 'create', id: s.id %>
                <% end %>
            <% end %>
        <% end %>


    </div>
    <script>
	    $(function(){
		    var textArea = document.getElementById('snippet-<%= s.id %>');
		    var myCodeMirror = CodeMirror.fromTextArea(textArea, {
			    lineNumbers: true,
			    theme: 'monokai',
			    lineWrapping: true,
			    readOnly: true,
			    mode: '<%= s.language %>'
		    });
	    })
    </script>
<% end %>
</div>

